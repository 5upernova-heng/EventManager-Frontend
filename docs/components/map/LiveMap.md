# LiveMap

LiveMap 是地图页面的重要组件。它能将传入的图片，配合节点和边的数据构成一个可拖拽的、显示节点与路线的完整 UI 组件

## 参数 Modal

| 参数名    | 类型    | 作用             |
| --------- | ------- | ---------------- |
| imgWidth  | number  | 图片高度         |
| imgHeight | number  | 图片宽度         |
| routes    | route[] | 路线             |
| allNodes  |         | 所有的节点数据   |
| navNodes  |         | 被加入导航的节点 |
| fixedX    |         | x 轴修正函数     |
| fixedY    |         | y 轴修正函数     |

LiveMap 由 MapController 控制。一旦被渲染出来，其就会绘制出对应的地图，以及应该显示在该地图上的节点和路线。

## 状态 Controller

- 选择节点进行导航时，应该显示出所有节点以供选择，被选中的节点将会被高亮；
- 计算出路线后，传入 LiveMap 的 routes 变得有数据，据此绘制出路线
- 如果是直接从事件的“计算路线”跳转过来，那么事件内包含的节点/路线将替换 LiveMap 中的对应节点/路线。

## 子组件 View

LiveMap 由三层元素叠加而成。

最底层为地图图片；中间层为一个 canvas，用于绘制路线；最顶层负责渲染所有的节点。之所以将节点与路线分开处理，是因为节点需要被点击，被悬浮（hover），产生逻辑交互。这是 canvas 比较难实现的。